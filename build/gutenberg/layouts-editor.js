!function(){"use strict";var t,e={2663:function(t,e,o){var i={};o.r(i),o.d(i,{apiFetch:function(){return l},setBlockData:function(){return c},updateBlockData:function(){return d}});var s={};o.r(s),o.d(s,{API_FETCH:function(){return p}});var a={};o.r(a),o.d(a,{getBlockData:function(){return v}});var r=window.wp.element,n=window.wp.data;function l(t){return{type:"API_FETCH",request:t}}function c(t){return{type:"SET_BLOCK_DATA",data:t}}function d(t){return{type:"UPDATE_BLOCK_DATA",data:t}}const{apiFetch:u}=wp;function p({request:t}){return u(t).then((t=>!!(t&&t.success&&t.response)&&t.response))}const{VPSavedLayoutVariables:h}=window;const{VPSavedLayoutVariables:f}=window;function v(t){return t.data||f.data}const m=(0,n.createReduxStore)("visual-portfolio/saved-layout-data",{reducer:function(t={data:h.data},e={}){switch(e.type){case"SET_BLOCK_DATA":if(e.data)return t?{...t,data:e.data}:e;break;case"UPDATE_BLOCK_DATA":if(e.data&&t)return{...t,data:{...t.data,...e.data}}}return t},selectors:a,actions:i,controls:s});(0,n.register)(m);var k=window.jQuery,w=o.n(k),g=window.wp.apiFetch,y=o.n(g),E=window.wp.blockEditor,b=window.wp.blocks,_=window.wp.components,B=window.wp.compose,S=window.wp.hooks,P=window.wp.i18n,O=window.wp.plugins;const{navigator:C,VPGutenbergVariables:A}=window,{plugin_name:D}=A;let T;function M(t){const[e,o]=(0,r.useState)(!1);return(0,r.createElement)("div",{className:"vpf-layout-shortcode-copy"},(0,r.createElement)("strong",null,t.label,":"),(0,r.createElement)("div",null,(0,r.createElement)("pre",null,t.content),(0,r.createElement)(_.Button,{isSmall:!0,onClick:()=>{C.clipboard.writeText(t.content).then((()=>{o(!0),clearTimeout(T),T=setTimeout((()=>{o(!1)}),450)}))}},(0,r.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},(0,r.createElement)("path",{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"}),(0,r.createElement)("path",{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"})),e?(0,r.createElement)("div",{className:"vpf-layout-shortcode-copied"},(0,P.__)("Copied!","visual-portfolio")):null)))}class x extends r.Component{constructor(...t){super(...t),this.state={additionalShortcodes:!1}}render(){const{postId:t,blockData:e,updateBlockData:o,clientId:i,VisualPortfolioBlockEdit:s}=this.props,{additionalShortcodes:a}=this.state;let n=[{label:(0,P.__)("This Saved Layout","visual-portfolio"),content:`[visual_portfolio id="${t}"]`},{label:(0,P.__)("Filter","visual-portfolio"),content:`[visual_portfolio_filter id="${t}" type="minimal" align="center" show_count="false" text_all="All"]`,isOptional:!0},{label:(0,P.__)("Sort","visual-portfolio"),content:`[visual_portfolio_sort id="${t}" type="minimal" align="center"]`,isOptional:!0}];return n=(0,S.applyFilters)("vpf.layouts-editor.shortcodes-list",n,this),(0,r.createElement)(r.Fragment,null,(0,r.createElement)(E.InspectorControls,null,(0,r.createElement)(_.PanelBody,{title:(0,P.__)("Shortcodes","visual-portfolio"),scrollAfterOpen:!0},(0,r.createElement)("p",null,(0,P.__)("To output this saved layout and its components you can use the following shortcodes:")),n.map((t=>t.isOptional?null:(0,r.createElement)(M,{key:`shortcode-${t.label}`,...t}))),a?(0,r.createElement)(r.Fragment,null,n.map((t=>t.isOptional?(0,r.createElement)(M,{key:`shortcode-${t.label}`,...t}):null)),(0,S.applyFilters)("vpf.layouts-editor.shortcodes","",this)):(0,r.createElement)(_.Button,{isLink:!0,onClick:()=>{this.setState({additionalShortcodes:!a})}},(0,P.__)("Show Additional Shortcodes","visual-portfolio")))),(0,r.createElement)(s,{attributes:{...e,block_id:e.id||i},setAttributes:t=>{o(t)},clientId:i}))}}const L=(0,B.compose)([(0,n.withSelect)((t=>{const e=t("visual-portfolio/saved-layout-data").getBlockData();return{postId:t("core/editor").getCurrentPostId(),blockData:e,VisualPortfolioBlockEdit:t("core/blocks").getBlockType("visual-portfolio/block")?.edit||(()=>null)}})),(0,n.withDispatch)((t=>({updateBlockData(e){t("visual-portfolio/saved-layout-data").updateBlockData(e)}})))])(x);(0,b.registerBlockType)("visual-portfolio/saved-editor",{title:(0,P.sprintf)((0,P.__)("%s Editor","visual-portfolio"),D),description:(0,P.sprintf)((0,P.__)("Edit saved %s layouts.","visual-portfolio"),D),icon:{foreground:"#2540CC",src:(0,r.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,r.createElement)("mask",{id:"mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"9",y:"8",width:"5",height:"6"},(0,r.createElement)("path",{d:"M11.1409 14L13.0565 8.49994H11.2789L9.55397 14H11.1409Z",fill:"url(#paint0_linear)"})),(0,r.createElement)("g",{mask:"url(#mask0)"},(0,r.createElement)("path",{d:"M11.1409 14L13.0565 8.49994H11.2789L9.55397 14H11.1409Z",fill:"currentColor"})),(0,r.createElement)("path",{d:"M8.90795 14L6.9923 8.49994H8.76989L10.4948 14H8.90795Z",fill:"currentColor"}),(0,r.createElement)("path",{d:"M19 16.2222C19 16.6937 18.8104 17.1459 18.4728 17.4793C18.1352 17.8127 17.6774 18 17.2 18H2.8C2.32261 18 1.86477 17.8127 1.52721 17.4793C1.18964 17.1459 1 16.6937 1 16.2222V3.77778C1 3.30628 1.18964 2.8541 1.52721 2.5207C1.86477 2.1873 2.32261 2 2.8 2H7.3L9.1 4.66667H17.2C17.6774 4.66667 18.1352 4.85397 18.4728 5.18737C18.8104 5.52076 19 5.97295 19 6.44444V16.2222Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"transparent"}),(0,r.createElement)("defs",null,(0,r.createElement)("linearGradient",{id:"paint0_linear",x1:"12.191",y1:"8.49994",x2:"7.44436",y2:"15.1301",gradientUnits:"userSpaceOnUse"},(0,r.createElement)("stop",null),(0,r.createElement)("stop",{offset:"1",stopOpacity:"0"}))))},category:"common",supports:{html:!1,className:!1,customClassName:!1,anchor:!1,inserter:!1},edit:L,save(){return null}});class V extends r.Component{componentDidMount(){const{isSavingPost:t,isAutosavingPost:e}=this.props;this.defaultBlockData=!1,this.editorRefreshTimeout=!1,this.wasSavingPost=t,this.wasAutosavingPost=e,this.update()}componentDidUpdate(){this.update()}update(){this.changeToVisualMode(),this.addBlock(),this.alwaysSelectBlock(),this.checkIfPostEdited(),this.saveMetaOnPostUpdate()}changeToVisualMode(){const{editorSettings:t,editorMode:e,switchEditorMode:o}=this.props;t.richEditingEnabled&&"text"===e&&o()}addBlock(){if(this.blocksRestoreBusy)return;const{resetBlocks:t,insertBlocks:e,blocks:o}=this.props;1===o.length&&o[0]&&"visual-portfolio/saved-editor"===o[0].name||(this.blocksRestoreBusy=!0,t([]),e((0,b.createBlock)("visual-portfolio/saved-editor")),this.blocksRestoreBusy=!1)}alwaysSelectBlock(){const{selectedBlock:t,blocks:e,selectBlock:o}=this.props;if(t&&"visual-portfolio/saved-editor"===t.name)return;if(w()(".editor-post-title__block.is-selected, .editor-post-title.is-selected").length)return;let i="";e.forEach((t=>{"visual-portfolio/saved-editor"===t.name&&(i=t.clientId)})),i&&o(i)}checkIfPostEdited(){const{isSavingPost:t,isAutosavingPost:e,blockData:o,editPost:i}=this.props;o&&Object.keys(o).length&&(t||e||!this.defaultBlockData?this.defaultBlockData=JSON.stringify(o):(clearTimeout(this.editorRefreshTimeout),this.editorRefreshTimeout=setTimeout((()=>{this.defaultBlockData!==JSON.stringify(o)&&i({edited:new Date})}),150)))}saveMetaOnPostUpdate(){const{isSavingPost:t,isAutosavingPost:e,postId:o,blockData:i}=this.props,s=this.wasSavingPost&&!t&&!this.wasAutosavingPost;if(this.wasSavingPost=t,this.wasAutosavingPost=e,s){const t={};Object.keys(i).forEach((e=>{t[`vp_${e}`]=i[e]})),y()({path:"/visual-portfolio/v1/update_layout/",method:"POST",data:{data:t,post_id:o}}).catch((t=>{console.log(t)}))}}render(){return null}}(0,O.registerPlugin)("vpf-saved-layouts-editor",{render:(0,B.compose)((0,n.withSelect)((t=>{const{isSavingPost:e,isAutosavingPost:o,getCurrentPostId:i,getEditorSettings:s}=t("core/editor"),{getSelectedBlock:a,getBlocks:r}=t("core/block-editor"),{getEditorMode:n}=t("core/edit-post"),{getBlockData:l}=t("visual-portfolio/saved-layout-data");return{isSavingPost:e(),isAutosavingPost:o(),selectedBlock:a(),editorSettings:s(),editorMode:n(),blocks:r(),postId:i(),blockData:l()}})),(0,n.withDispatch)((t=>{const{selectBlock:e,insertBlocks:o,resetBlocks:i}=t("core/block-editor"),{editPost:s}=t("core/editor"),{switchEditorMode:a}=t("core/edit-post");return{selectBlock:e,insertBlocks:o,resetBlocks:i,editPost:s,switchEditorMode:a}})))(V)})}},o={};function i(t){var s=o[t];if(void 0!==s)return s.exports;var a=o[t]={exports:{}};return e[t](a,a.exports,i),a.exports}i.m=e,t=[],i.O=function(e,o,s,a){if(!o){var r=1/0;for(d=0;d<t.length;d++){o=t[d][0],s=t[d][1],a=t[d][2];for(var n=!0,l=0;l<o.length;l++)(!1&a||r>=a)&&Object.keys(i.O).every((function(t){return i.O[t](o[l])}))?o.splice(l--,1):(n=!1,a<r&&(r=a));if(n){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[o,s,a]},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){var t={3997:0,4274:0};i.O.j=function(e){return 0===t[e]};var e=function(e,o){var s,a,r=o[0],n=o[1],l=o[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(s in n)i.o(n,s)&&(i.m[s]=n[s]);if(l)var d=l(i)}for(e&&e(o);c<r.length;c++)a=r[c],i.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return i.O(d)},o=self.webpackChunkvisual_portfolio=self.webpackChunkvisual_portfolio||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var s=i.O(void 0,[4274],(function(){return i(2663)}));s=i.O(s)}();