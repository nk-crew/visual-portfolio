!function(){"use strict";var e=window.wp.element;var t=window.wp.i18n,o=window.wp.compose,i=window.wp.data,a=window.wp.components,n=window.wp.editPost,r=window.wp.plugins;const{jQuery:l,ajaxurl:s,VPGutenbergMetaVariables:d}=window;class m extends e.Component{constructor(e){var t,o,i,a,n,r,l,s;super(e),this.state={oembedQuery:"",oembedHTML:""},this.maybePrepareOembed=(t=300,n=this.maybePrepareOembed.bind(this),r=[],l=null,s=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];r=t,l||(l=requestAnimationFrame((function(){l=null,n.apply(void 0,r)})))},s.cancel=function(){l&&(cancelAnimationFrame(l),l=null)},o=s,a=(i||{}).atBegin,function(e,t,o){var i,a=o||{},n=a.noTrailing,r=void 0!==n&&n,l=a.noLeading,s=void 0!==l&&l,d=a.debounceMode,m=void 0===d?void 0:d,c=!1,u=0;function p(){i&&clearTimeout(i)}function v(){for(var o=arguments.length,a=new Array(o),n=0;n<o;n++)a[n]=arguments[n];var l=this,d=Date.now()-u;function v(){u=Date.now(),t.apply(l,a)}function h(){i=void 0}c||(s||!m||i||v(),p(),void 0===m&&d>e?s?(u=Date.now(),r||(i=setTimeout(m?h:v,e))):v():!0!==r&&(i=setTimeout(m?h:v,void 0===m?e-d:e)))}return v.cancel=function(e){var t=(e||{}).upcomingOnly,o=void 0!==t&&t;p(),c=!o},v}(t,o,{debounceMode:!1!==(void 0!==a&&a)}))}componentDidMount(){this.maybePrepareOembed()}componentDidUpdate(){this.maybePrepareOembed()}maybePrepareOembed(){const{oembedQuery:e,oembedHTML:t}=this.state,{getMeta:o,postFormat:i}=this.props;if("video"!==i)return;const a=o("_vp_format_video_url");e!==a&&(this.oembedAjax&&this.oembedAjax.abort&&this.oembedAjax.abort(),e||!t?this.oembedAjax=l.ajax({url:s,method:"POST",dataType:"json",data:{action:"vp_find_oembed",q:a,nonce:d.nonce},complete:e=>{const t=e.responseJSON,o={oembedQuery:a,oembedHTML:""};t&&void 0!==t.html&&(o.oembedHTML=t.html),this.setState(o),this.oembedAjax=null}}):this.setState({oembedHTML:""}))}render(){const{getMeta:o,postFormat:i,updateMeta:r}=this.props,{oembedHTML:l}=this.state;return"video"!==i?null:(0,e.createElement)(n.PluginDocumentSettingPanel,{name:"VPVideo",title:(0,t.__)("Video","visual-portfolio"),icon:(0,e.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M19.25 10C19.25 15.1086 15.1086 19.25 10 19.25C4.89137 19.25 0.75 15.1086 0.75 10C0.75 4.89137 4.89137 0.75 10 0.75C15.1086 0.75 19.25 4.89137 19.25 10Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"transparent"}),(0,e.createElement)("path",{d:"M8 12.6326V7.36671C8.00011 7.30082 8.01856 7.23618 8.05342 7.17955C8.08828 7.12293 8.13826 7.0764 8.19812 7.04485C8.25798 7.0133 8.32552 6.99789 8.39367 7.00023C8.46181 7.00257 8.52805 7.02258 8.58544 7.05816L12.8249 9.69035C12.8786 9.72358 12.9228 9.76933 12.9534 9.82337C12.984 9.87742 13 9.93803 13 9.99963C13 10.0612 12.984 10.1218 12.9534 10.1759C12.9228 10.2299 12.8786 10.2757 12.8249 10.3089L8.58544 12.9418C8.52805 12.9774 8.46181 12.9974 8.39367 12.9998C8.32552 13.0021 8.25798 12.9867 8.19812 12.9551C8.13826 12.9236 8.08828 12.8771 8.05342 12.8204C8.01856 12.7638 8.00011 12.6992 8 12.6333V12.6326Z",fill:"currentColor"})),className:"vpf-meta-video-panel"},(0,e.createElement)(a.PanelRow,null,(0,e.createElement)("p",{className:"description"},(0,t.sprintf)((0,t.__)("Video will be used in %s layouts only. Full list of supported links","visual-portfolio"),d.plugin_name),"Â ",(0,e.createElement)("a",{href:"https://visualportfolio.co/docs/projects/video-project/#supported-video-vendors",target:"_blank",rel:"noopener noreferrer"},(0,t.__)("see here","visual-portfolio")))),(0,e.createElement)(a.PanelRow,null,(0,e.createElement)(a.TextControl,{label:(0,t.__)("Video URL","visual-portfolio"),value:o("_vp_format_video_url")||"",onChange:e=>{r("_vp_format_video_url",e)},type:"url",placeholder:"https://"})),(0,e.createElement)(a.PanelRow,null,(0,e.createElement)("div",{className:"vp-oembed-preview",dangerouslySetInnerHTML:{__html:l}})))}}const c=(0,o.compose)([(0,i.withSelect)((e=>({getMeta(t){return(e("core/editor").getEditedPostAttribute("meta")||{})[t]},postFormat:e("core/editor").getEditedPostAttribute("format")}))),(0,i.withDispatch)((e=>({updateMeta(t,o){e("core/editor").editPost({meta:{[t]:o}})}}))),o.withInstanceId])(m);wp.editPost&&(0,r.registerPlugin)("vp-video",{render:c});var u=window.wp.hooks;class p extends e.Component{render(){const{getMeta:o,thumbnailData:i,updateMeta:n}=this.props;let r="";if(i){const e="post-thumbnail";if(r=i.source_url,!i.mime_type||"image/gif"!==i.mime_type)if(i.media_details&&i.media_details.sizes&&i.media_details.sizes[e])r=i.media_details.sizes[e].source_url;else{const e="thumbnail";i.media_details&&i.media_details.sizes&&i.media_details.sizes[e]&&(r=i.media_details.sizes[e].source_url)}}if(!r)return null;let l=o("_vp_image_focal_point");return l&&l.x&&l.y||(l={x:"0.5",y:"0.5"}),(0,e.createElement)("div",{className:"vpf-post-image-focal-point-panel"},(0,e.createElement)(a.PanelRow,null,(0,e.createElement)("p",{className:"description"},(0,t.__)("Focal point will be used in Visual Portfolio layouts only.","visual-portfolio"))),(0,e.createElement)(a.PanelRow,null,(0,e.createElement)(a.FocalPointPicker,{url:r,value:l,onChange:e=>{n("_vp_image_focal_point",e)}})))}}const v=(0,o.compose)([(0,i.withSelect)((e=>{const{getEditedPostAttribute:t}=e("core/editor"),{getMedia:o}=e("core"),i=t("featured_media"),a=t("meta")||{};return{thumbnailData:i?o(i):null,getMeta(e){return a[e]}}})),(0,i.withDispatch)((e=>({updateMeta(t,o){e("core/editor").editPost({meta:{[t]:o}})}}))),o.withInstanceId])(p);(0,u.addFilter)("editor.PostFeaturedImage","vpf/post-featured-image-focal-point",(t=>function(o){return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(v,null),(0,e.createElement)(t,{...o}))}))}();