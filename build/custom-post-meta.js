!function(){"use strict";var e=window.wp.element;const{__:__,sprintf:t}=wp.i18n,{withInstanceId:o,compose:n}=wp.compose,{withSelect:a,withDispatch:i}=wp.data,{Component:r}=wp.element,{PanelRow:l,TextControl:s}=wp.components,{PluginDocumentSettingPanel:d}=wp.editPost||{},{registerPlugin:m}=wp.plugins,{jQuery:c,ajaxurl:p,VPGutenbergMetaVariables:u}=window,h=n([a((e=>({getMeta(t){return(e("core/editor").getEditedPostAttribute("meta")||{})[t]},postFormat:e("core/editor").getEditedPostAttribute("format")}))),i((e=>({updateMeta(t,o){e("core/editor").editPost({meta:{[t]:o}})}}))),o])(class extends r{constructor(e){var t,o,n,a,i,r,l,s;super(e),this.state={oembedQuery:"",oembedHTML:""},this.maybePrepareOembed=(t=300,i=this.maybePrepareOembed.bind(this),r=[],l=null,s=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];r=t,l||(l=requestAnimationFrame((function(){l=null,i.apply(void 0,r)})))},s.cancel=function(){l&&(cancelAnimationFrame(l),l=null)},o=s,a=(n||{}).atBegin,function(e,t,o){var n,a=o||{},i=a.noTrailing,r=void 0!==i&&i,l=a.noLeading,s=void 0!==l&&l,d=a.debounceMode,m=void 0===d?void 0:d,c=!1,p=0;function u(){n&&clearTimeout(n)}function h(){for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];var l=this,d=Date.now()-p;function h(){p=Date.now(),t.apply(l,a)}function _(){n=void 0}c||(s||!m||n||h(),u(),void 0===m&&d>e?s?(p=Date.now(),r||(n=setTimeout(m?_:h,e))):h():!0!==r&&(n=setTimeout(m?_:h,void 0===m?e-d:e)))}return h.cancel=function(e){var t=(e||{}).upcomingOnly,o=void 0!==t&&t;u(),c=!o},h}(t,o,{debounceMode:!1!==(void 0!==a&&a)}))}componentDidMount(){this.maybePrepareOembed()}componentDidUpdate(){this.maybePrepareOembed()}maybePrepareOembed(){const{oembedQuery:e,oembedHTML:t}=this.state,{getMeta:o,postFormat:n}=this.props;if("video"!==n)return;const a=o("_vp_format_video_url");e!==a&&(this.oembedAjax&&this.oembedAjax.abort&&this.oembedAjax.abort(),e||!t?this.oembedAjax=c.ajax({url:p,method:"POST",dataType:"json",data:{action:"vp_find_oembed",q:a,nonce:u.nonce},complete:e=>{const t=e.responseJSON,o={oembedQuery:a,oembedHTML:""};t&&void 0!==t.html&&(o.oembedHTML=t.html),this.setState(o),this.oembedAjax=null}}):this.setState({oembedHTML:""}))}render(){const{getMeta:o,postFormat:n,updateMeta:a}=this.props,{oembedHTML:i}=this.state;return"video"!==n?null:(0,e.createElement)(d,{name:"VPVideo",title:__("Video","visual-portfolio"),icon:(0,e.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,e.createElement)("path",{d:"M19.25 10C19.25 15.1086 15.1086 19.25 10 19.25C4.89137 19.25 0.75 15.1086 0.75 10C0.75 4.89137 4.89137 0.75 10 0.75C15.1086 0.75 19.25 4.89137 19.25 10Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"transparent"}),(0,e.createElement)("path",{d:"M8 12.6326V7.36671C8.00011 7.30082 8.01856 7.23618 8.05342 7.17955C8.08828 7.12293 8.13826 7.0764 8.19812 7.04485C8.25798 7.0133 8.32552 6.99789 8.39367 7.00023C8.46181 7.00257 8.52805 7.02258 8.58544 7.05816L12.8249 9.69035C12.8786 9.72358 12.9228 9.76933 12.9534 9.82337C12.984 9.87742 13 9.93803 13 9.99963C13 10.0612 12.984 10.1218 12.9534 10.1759C12.9228 10.2299 12.8786 10.2757 12.8249 10.3089L8.58544 12.9418C8.52805 12.9774 8.46181 12.9974 8.39367 12.9998C8.32552 13.0021 8.25798 12.9867 8.19812 12.9551C8.13826 12.9236 8.08828 12.8771 8.05342 12.8204C8.01856 12.7638 8.00011 12.6992 8 12.6333V12.6326Z",fill:"currentColor"})),className:"vpf-meta-video-panel"},(0,e.createElement)(l,null,(0,e.createElement)("p",{className:"description"},t(__("Video will be used in %s layouts only. Full list of supported links","visual-portfolio"),u.plugin_name),"Â ",(0,e.createElement)("a",{href:"https://visualportfolio.co/docs/projects/video-project/#supported-video-vendors",target:"_blank",rel:"noopener noreferrer"},__("see here","visual-portfolio")))),(0,e.createElement)(l,null,(0,e.createElement)(s,{label:__("Video URL","visual-portfolio"),value:o("_vp_format_video_url")||"",onChange:e=>{a("_vp_format_video_url",e)},type:"url",placeholder:"https://"})),(0,e.createElement)(l,null,(0,e.createElement)("div",{className:"vp-oembed-preview",dangerouslySetInnerHTML:{__html:i}})))}});wp.editPost&&m("vp-video",{render:h});const{__:_}=wp.i18n,{withInstanceId:v,compose:b}=wp.compose,{withSelect:f,withDispatch:w}=wp.data,{Component:g}=wp.element,{PanelRow:y,FocalPointPicker:P}=wp.components,{addFilter:C}=wp.hooks,M=b([f((e=>{const{getEditedPostAttribute:t}=e("core/editor"),{getMedia:o}=e("core"),n=t("featured_media"),a=t("meta")||{};return{thumbnailData:n?o(n):null,getMeta(e){return a[e]}}})),w((e=>({updateMeta(t,o){e("core/editor").editPost({meta:{[t]:o}})}}))),v])(class extends g{render(){const{getMeta:t,thumbnailData:o,updateMeta:n}=this.props;let a="";if(o){const e="post-thumbnail";if(a=o.source_url,!o.mime_type||"image/gif"!==o.mime_type)if(o.media_details&&o.media_details.sizes&&o.media_details.sizes[e])a=o.media_details.sizes[e].source_url;else{const e="thumbnail";o.media_details&&o.media_details.sizes&&o.media_details.sizes[e]&&(a=o.media_details.sizes[e].source_url)}}if(!a)return null;let i=t("_vp_image_focal_point");return i&&i.x&&i.y||(i={x:"0.5",y:"0.5"}),(0,e.createElement)("div",{className:"vpf-post-image-focal-point-panel"},(0,e.createElement)(y,null,(0,e.createElement)("p",{className:"description"},_("Focal point will be used in Visual Portfolio layouts only.","visual-portfolio"))),(0,e.createElement)(y,null,(0,e.createElement)(P,{url:a,value:i,onChange:e=>{n("_vp_image_focal_point",e)}})))}});C("editor.PostFeaturedImage","vpf/post-featured-image-focal-point",(t=>function(o){return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(M,null),(0,e.createElement)(t,o))}))}();
